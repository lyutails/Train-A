<div class="d-flex justify-content-center align-items-center vh-100">
  <div class="profile_container">
    <h2>Profile</h2>
    <!-- <div *ngIf="!isEditingName; else editNameTemplate"> -->
    <form [formGroup]="profileForm" #editNameTemplate>
      <div *ngIf="!isEditingName" matTooltip="Please fill in your name">
        <span>{{ userCredentials.name }}</span>
        <button mat-icon-button (click)="startEditing('name')" aria-label="Edit name">
          <mat-icon>edit</mat-icon>
        </button>
      </div>
      <mat-form-field appearance="outline" class="profile_field">
        <mat-label>Edit Name</mat-label>
        <input matInput formControlName="name" />
        @if (profileForm.controls['name'].hasError('required')) {
          <mat-error> Name is required </mat-error>
        }
        @if (profileForm.controls['name'].hasError('minlength')) {
          <mat-error> Name must be at least 3 characters long </mat-error>
        }
        @if (profileForm.controls['name'].hasError('maxlength')) {
          <mat-error> Name cannot exceed 50 characters </mat-error>
        }
      </mat-form-field>
      <button
        mat-icon-button
        (click)="saveName()"
        aria-label="Save name"
        [disabled]="!profileForm.controls['name'].valid"
      >
        <mat-icon>save</mat-icon>
      </button>
      <div>
        <!-- <div *ngIf="!isEditingEmail; else editEmailTemplate"> -->
        <div *ngIf="!isEditingEmail">
          <span>{{ userCredentials.email }}</span>
          <button mat-icon-button (click)="startEditing('email')" aria-label="Edit email">
            <mat-icon>edit</mat-icon>
          </button>
        </div>
        <mat-form-field appearance="outline" class="profile_field">
          <mat-label>Edit Email</mat-label>
          <input matInput formControlName="email" appearance="outline" />
          @if (profileForm.controls['email'].hasError('required')) {
            <mat-error> Email is required </mat-error>
          }
          @if (profileForm.controls['email'].hasError('pattern')) {
            <mat-error>Invalid email format </mat-error>
          }
        </mat-form-field>
        <button
          mat-icon-button
          (click)="saveEmail()"
          aria-label="Save email"
          [disabled]="!profileForm.controls['email'].valid"
        >
          <mat-icon>save</mat-icon>
        </button>
      </div>
    </form>
    <div class="action_buttons">
      <button mat-flat-button (click)="openChangePasswordModal()">Change Password</button>
      <button mat-flat-button (click)="logout()">Logout</button>
    </div>
  </div>
</div>
