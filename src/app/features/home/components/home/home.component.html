<div class="home_wrapper container-xl">
  <p class="home_title" [style.color]="'oklch(49.71% 0.165 259.85deg)'">Pick trip parameters</p>
  <form class="home_form" [formGroup]="searchForm" (ngSubmit)="onSubmit()">
    <div class="home_inputs-wrapper">
      <mat-form-field appearance="outline" class="home_form-input" formControlName="from"
        ><mat-label>From...</mat-label>
        <input
          matInput
          placeholder="From"
          formControlName="from"
          [value]="searchForm.controls.from.value | trim"
          [formControl]="cityControl"
          [matAutocomplete]="auto"
        />
        <mat-hint>Departure station</mat-hint><mat-icon matSuffix>store</mat-icon>
        <mat-autocomplete #auto="matAutocomplete">
          @for (city of filteredTestCities | async; track city) {
            <mat-option [value]="city">{{ city }}</mat-option>
          }
        </mat-autocomplete></mat-form-field
      >
      <mat-form-field appearance="outline" class="home_form-input" formControlName="to"
        ><mat-label>To...</mat-label>
        <input
          matInput
          placeholder="To"
          formControlName="to"
          [value]="searchForm.controls.to.value | trim"
          [formControl]="cityControl"
          [matAutocomplete]="auto"
        />
        <mat-hint>Arrival station</mat-hint><mat-icon matSuffix>castle</mat-icon>
        <mat-autocomplete #auto="matAutocomplete">
          @for (city of filteredTestCities | async; track city) {
            <mat-option [value]="city">{{ city }}</mat-option>
          }
        </mat-autocomplete></mat-form-field
      >
      <mat-form-field appearance="outline" class="home_form-input" formControlName="date"
        ><mat-label>Choose a date...</mat-label
        ><input matInput [matDatepicker]="picker" formControlName="date" [value]="searchForm.controls.date.value" />
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
    </div>
    <TTP-button
      (click)="getCarriages()"
      [type]="'button'"
      [width]="'10vw'"
      [buttonText]="'Carriage'"
      class="home_carriage-button"
      [disabled]="!searchForm.controls.from.valid && !searchForm.controls.to.valid && !searchForm.controls.date.valid"
    ></TTP-button>
  </form>
  <div class="home_carriages">
    @for (carriage of testCarriages; track carriage) {
      <div class="home_shape-params">
        <p class="home_carriage-details">{{ testCarriages[1].name }}</p>
        <p class="home_carriage-details">{{ testCarriages[1].rows }}</p>
        <p class="home_carriage-details">{{ testCarriages[1].leftSeats }}</p>
        <p class="home_carriage-details">{{ testCarriages[1].rightSeats }}</p>
        <p class="home_carriage-details">Chosen seat:</p>
        <div class="home_carriage-shape">
          @if (searchForm.controls.from.value && searchForm.controls.to.value && searchForm.controls.date.value) {
            @for (carriage of testCarriages; track index; let index = $index) {
              @if (testCarriages[1].name !== undefined) {
                <TTP-carriage-row
                  class="home_carriage-row"
                  [carriageName]="testCarriages[1].name"
                  [rowNumber]="index"
                  [leftSeatCount]="testCarriages[1].leftSeats"
                  [rightSeatCount]="testCarriages[1].rightSeats"
                ></TTP-carriage-row>
              }
            }
          }
        </div>
      </div>
    }
  </div>
  <TTP-button
    (click)="searchTrips()"
    [type]="'submit'"
    [width]="'10vw'"
    [buttonText]="'Search' | uppercase"
    class="home_search-button"
    [disabled]="!searchForm.valid"
  ></TTP-button>
</div>
